webpackJsonp([1],{"14gb":function(t,e,a){"use strict";var s=new(a("7+uW").default);e.a=s},"6Tc7":function(t,e,a){"use strict";var s={name:"date-picker",data:()=>({pickerOptions:{shortcuts:[{text:"最近一周",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-6048e5),t.$emit("pick",[a,e])}},{text:"最近一个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-2592e6),t.$emit("pick",[a,e])}},{text:"最近三个月",onClick(t){const e=new Date,a=new Date;a.setTime(a.getTime()-7776e6),t.$emit("pick",[a,e])}}]},dateValue:""}),methods:{change:function(){this.$emit("message",this.dateValue)}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form-item",{attrs:{label:"Date","label-width":"120px"}},[a("el-date-picker",{attrs:{size:"small",type:"datetimerange","picker-options":t.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},on:{change:t.change},model:{value:t.dateValue,callback:function(e){t.dateValue=e},expression:"dateValue"}})],1)},staticRenderFns:[]};var n=a("VU/8")(s,i,!1,function(t){a("9MTr")},"data-v-b0b95c32",null);e.a=n.exports},"7GQ7":function(t,e){},"8vCp":function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__Metric__=__webpack_require__("LwbF"),__WEBPACK_IMPORTED_MODULE_1__DatePicker__=__webpack_require__("6Tc7");__webpack_exports__.a={name:"insert",components:{metric:__WEBPACK_IMPORTED_MODULE_0__Metric__.a,"date-picker":__WEBPACK_IMPORTED_MODULE_1__DatePicker__.a},data:()=>({labelPosition:"right",totalTags:[],range:5,activeName:"addData",metricName:"",tags:{},datapoints:[],date:[],value:"var dataPoints = [];\nstartTime = new Date(startTime);\nwhile (startTime <= endTime) {\n    dataPoints.push([startTime.getTime(), parseFloat(123.123)]);\n    startTime.setMinutes(startTime.getMinutes() + 5);// 加五分钟\n    //startTime.setHours(startTime.getHours() + 1);//加一个小时\n    //startTime.setDate(startTime.getDate() + 1);// 加一天\n    //startTime.setMonth(startTime.getMonth() + 1); //加一个月\n    //startTime.setFullYear(startTime.getFullYear() + 1); //加一年\n}\nreturn dataPoints;\n}",loading:!1,tagsValue:{},currTagValues:[],inputMetricName:"",dynamicTags:[],inputTagVisible:!1,inputTagValue:""}),created(){},methods:{updateMetric:function(t){this.metricName=t,this.getTags(t)},updateDate:function(t){this.date=t.map(t=>(t.setMilliseconds(0),t.getTime()))},getTags:function(t){this.totalTags=[];var e={metrics:[{tags:{},name:t}],plugins:[],cache_time:0,start_absolute:0};this.loading=!0,this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/query/tags",e).then(t=>{var e=t.data.queries[0].results[0].tags;for(var a in e)this.totalTags.push({label:a,name:a,value:""});this.tagsValue=e,this.loading=!1},t=>{this.loading=!1})},submit:function(){if(-1===this.value.indexOf("."))return void this.$message.warning("数据值必须为浮点数");this.clearParam();for(let t,e=0;t=this.totalTags[e++];)this.tags[t.name]=t.value;this.date[0];this.datapoints=this.customerFun(this.date[0],this.date[1]);let t=[{name:this.metricName,tags:this.tags,datapoints:this.datapoints}];this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints",t).then(t=>{console.log(t),t.status="",this.loading=!1,this.$message({message:"添加成功",type:"success"})},t=>{this.loading=!1,this.$message.error("添加失败")})},addMetric:function(){let t={};this.dynamicTags.forEach(e=>{t[e]="first"});let e=[{name:this.inputMetricName,datapoints:[[0,0]],tags:t}];this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints",e).then(t=>{console.log(t),t.status="",this.loading=!1,this.$message({message:"添加成功",type:"success"})},t=>{this.loading=!1,this.$message.error("添加失败")})},clearParam:function(){this.tags={},this.datapoints=[]},handleClose(t){this.dynamicTags.splice(this.dynamicTags.indexOf(t),1)},showInput(){this.inputTagVisible=!0,this.$nextTick(t=>{this.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm(){let t=this.inputTagValue;t&&this.dynamicTags.push(t),this.inputTagVisible=!1,this.inputTagValue=""},querySearch:function(t,e){e(t?this.currTagValues.filter(this.filter(t)):this.currTagValues)},filter:t=>e=>-1!==e.value.toLowerCase().indexOf(t.toLowerCase()),onFocus:function(t){this.currTagValues=[],this.tagsValue[t].forEach(t=>{this.currTagValues.push({value:t})})},customerFun:function(startTime,endTime){var date=new Date,o=eval("({a:function(startTime, endTime) { "+this.value+"})"),result=o.a(startTime,endTime);return result}}}},"9MTr":function(t,e){},AJay:function(t,e){},HwxV:function(t,e){},LwbF:function(t,e,a){"use strict";var s=a("14gb"),i={name:"metric",data:()=>({options:[],input:"",width:"20em"}),created(){s.a.$on("change-kdb",()=>{this.getMetric()})},mounted(){this.getMetric()},methods:{getMetric:function(){this.options=[];this.$util.axios.get(this.$kdb.url+"/api/v1/metricnames").then(t=>{for(var e=null,a=0;e=t.data.results[a++];)e.length>20&&(this.width=e.length+"em"),this.options.push({label:e,value:e});console.log(this.options)},t=>{})},change:function(){this.$emit("message",this.input)}}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form-item",{attrs:{label:"Metric","label-width":"120px"}},[a("el-select",{style:{width:t.width},attrs:{size:"small",filterable:"",placeholder:"请选择"},on:{change:t.change},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1)},staticRenderFns:[]};var l=a("VU/8")(i,n,!1,function(t){a("PmuS")},"data-v-598b6e59",null);e.a=l.exports},M4Cq:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),i=a("zL8q"),n=a.n(i),l=(a("tvR6"),{render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]});var r=a("VU/8")({name:"App"},l,!1,function(t){a("gsu9")},null,null).exports,o=a("/ocq"),c=a("LwbF"),u=a("6Tc7"),h=a("14gb"),d=a("sJst"),m=a.n(d),p={props:{type:{type:String,default:"xls"},data:{type:Array,required:!0},fields:{type:Object,required:!0},title:{default:null},name:{type:String,default:"data.xls"},meta:{type:Array,default:()=>[]}},computed:{idName:function(){return"export_"+(new Date).getTime()}},methods:{generate(){if(!this.data.length)return;let t=this.getProcessedJson(this.data,this.fields);return"csv"==this.type?this.export(this.jsonToCSV(t),this.name,"application/csv"):this.export(this.jsonToXLS(t),this.name,"application/vnd.ms-excel")},export:function(t,e,a){let s=this.base64ToBlob(t,a);m()(s,e,a)},jsonToXLS:function(t){let e="<thead><tr>";if(null!=this.title)if(Array.isArray(this.title))for(var a=0;a<this.title.length;a++)e+='<th colspan="'+Object.keys(t[0]).length+'">'+this.title[a]+"<th></tr><tr>";else e+='<th colspan="'+Object.keys(t[0]).length+'">'+this.title+"<th></tr><tr>";for(let a in t[0])e+="<th>"+a+"</th>";return e+="</tr></thead>",e+="<tbody>",t.map(function(t,a){e+="<tbody><tr>";for(let a in t)e+="<td>"+t[a]+"</td>";e+="</tr></tbody>"}),'<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>${table}</table></body></html>'.replace("${table}",e)},jsonToCSV:function(t){var e="";if(null!=this.title)if(Array.isArray(this.title))for(var a=0;a<this.title.length;a++)e+=this.title[a]+"\r\n";else e+=this.title+"\r\n";for(let a in t[0])e+=a+",";return e=e.slice(0,e.length-1),e+="\r\n",t.map(function(t){for(let a in t){let s=t[a]+"";s.match(/[,"\n]/)&&(s='"'+s.replace(/\"/g,'""')+'"'),e+=s+","}e=e.slice(0,e.length-1),e+="\r\n"}),e},getProcessedJson:function(t,e){let a=this.getKeys(t,e),s=[],i=this;return t.map(function(t,e){let n={};for(let e in a){let s=a[e];n[e]=i.getNestedData(s,t)}s.push(n)}),s},getKeys:function(t,e){if(e)return e;let a={};for(let e in t[0])a[e]=e;return a},callItemCallback:function(t,e){return"object"==typeof t&&"function"==typeof t.callback?t.callback(e):e},getNestedData:function(t,e){let a=null,s=("object"==typeof t?t.field:t).split(".");a=e[s[0]];for(let t=1;t<s.length;t++)a=a[s[t]];return a=this.callItemCallback(t,a)},base64ToBlob:function(t,e){let a=window.btoa(window.unescape(encodeURIComponent(t))),s=atob(a),i=s.length,n=new Uint8ClampedArray(i);for(;i--;)n[i]=s.charCodeAt(i);return new Blob([n],{type:e})}}},g={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:this.idName},on:{click:this.generate}},[this._t("default",[this._v("\n\t\tDownload "+this._s(this.name)+"\n\t")])],2)},staticRenderFns:[]},f={name:"table",components:{"download-excel":a("VU/8")(p,g,!1,null,null,null).exports},props:["columns","data","tags","metric"],data:()=>({tableData:[],dataEnd:[],currentPage:1,pagesize:100,filterText:"",excel:{json_fields:{"Complete name":"name"},json_data:[{name:"Tony Peña"},{name:"Thessaloniki"}],json_meta:[[{key:"charset",value:"utf-8"}]]}}),computed:{excelFileds:function(){let t={};return this.tags.forEach(e=>{t[e]=e}),t.date="date",t.value="value",t}},created(){h.a.$on("table-data-change",t=>{this.tableData=t,this.doFilter()})},mounted(){},methods:{doFilter:function(){0===this.filterText.length?this.dataEnd=this.tableData:(this.dataEnd=[],this.tableData.forEach((t,e)=>{let a=!1;for(let e in t)if(t[e]&&(t[e]+"").indexOf(this.filterText)>=0){a=!0;break}a&&(t.index=e,this.dataEnd.push(t))}),this.currentPage=1)},alter:function(t){t.editFlag=!1;let e={};this.tags.forEach(a=>{e[a]=t[a]});let a=[{name:this.metric,datapoints:[[t.time,t.value]],tags:e}];this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints",a).then(t=>{this.loading=!1,this.$message({message:"修改成功",type:"success"})},t=>{this.loading=!1,this.$message.error("修改失败")})},handleSizeChange:function(t){this.pagesize=t},handleCurrentChange:function(t){this.currentPage=t},handleDelete:function(t,e){let a={},s={};this.tags.forEach(t=>{s[t]=e[t]}),a.metrics=[],a.metrics.push({tags:s,name:this.metric}),a.plugins=[],a.cache_time=0,a.start_absolute=e.time,a.end_absolute=e.time,this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/delete",a).then(a=>{this.loading=!1,this.$message({message:"删除成功",type:"success"}),this.dataEnd.splice(t,1),void 0!==e.index&&this.tableData.splice(e.index,1)},t=>{this.loading=!1,this.$message.error("删除失败")})}}},v={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticStyle:{display:"flex","justify-content":"flex-start"}},[a("el-input",{staticClass:"search-input",staticStyle:{flex:"1","margin-right":"5px"},attrs:{size:"small",placeholder:"过滤",icon:"search"},on:{change:t.doFilter},model:{value:t.filterText,callback:function(e){t.filterText=e},expression:"filterText"}}),t._v(" "),a("download-excel",{staticStyle:{"margin-right":"5px"},attrs:{data:t.dataEnd.slice((t.currentPage-1)*t.pagesize,t.currentPage*t.pagesize),fields:t.excelFileds,name:"data.xls"}},[a("el-button",{attrs:{type:"primary",size:"small"}},[t._v("导出当前页")])],1),t._v(" "),a("download-excel",{staticStyle:{"margin-right":"5px"},attrs:{data:t.dataEnd,fields:t.excelFileds,name:"data.xls"}},[a("el-button",{attrs:{type:"primary",size:"small"}},[t._v("导出所有")])],1)],1),t._v(" "),a("el-table",{attrs:{data:t.dataEnd.slice((t.currentPage-1)*t.pagesize,t.currentPage*t.pagesize),border:"",stripe:"",height:"600",fit:"",size:"small",cellpadding:"2"}},[t._l(t.columns,function(t,e){return a("el-table-column",{key:e,attrs:{prop:t.key,label:t.name,sortable:"","show-overflow-tooltip":""}})}),t._v(" "),a("el-table-column",{attrs:{label:"date",prop:"date",sortable:""}}),t._v(" "),a("el-table-column",{attrs:{label:"value",sortable:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{on:{dblclick:function(t){e.row.editFlag=!0}}},[a("span",{directives:[{name:"show",rawName:"v-show",value:!e.row.editFlag,expression:"!scope.row.editFlag"}]},[t._v(t._s(e.row.value))]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.row.editFlag,expression:"scope.row.editFlag"}]},[a("el-input",{nativeOn:{keyup:function(a){if(!("button"in a)&&t._k(a.keyCode,"enter",13,a.key,"Enter"))return null;t.alter(e.row)}},model:{value:e.row.value,callback:function(a){t.$set(e.row,"value",a)},expression:"scope.row.value"}})],1)])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],2),t._v(" "),a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[100,500,1e3,2e3,4e3,5e3,1e4,5e4],"page-size":t.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:t.dataEnd.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)},staticRenderFns:[]};var b=a("VU/8")(f,v,!1,function(t){a("AJay")},"data-v-37138960",null).exports,y={name:"groupBy",props:["metricName"],data:()=>({options:[],input:"",width:"20em",groupType:"tags"}),mounted(){},watch:{metricName(t){this.getTags(t)}},methods:{getTags:function(t){this.options.length=0;let e=20;this.input=[];var a={metrics:[{tags:{},name:t}],plugins:[],cache_time:0,start_absolute:0};this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/query/tags",a).then(t=>{var a=t.data.queries[0].results[0].tags;for(var s in a)e+=s.length,this.options.push({label:s,value:s}),this.input.push(s);this.width=e+"em",console.log(this.options),h.a.$emit("change-tags",[this.options,a]),h.a.$emit("changeGroupBy",this.input)},t=>{})},change:function(){h.a.$emit("changeGroupBy",this.input)},chooseAll:function(){this.input=this.options.map(t=>t.value),h.a.$emit("changeGroupBy",this.input)},clear:function(){this.input=[],h.a.$emit("changeGroupBy",this.input)}}},_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-form-item",{attrs:{label:"Group By"}},[a("el-select",{attrs:{filterable:"",placeholder:"请选择",size:"small"},model:{value:t.groupType,callback:function(e){t.groupType=e},expression:"groupType"}},[a("el-option",{attrs:{label:"Tags",value:"tags"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:"Tags"}},[a("el-select",{style:{width:t.width},attrs:{size:"small",multiple:"",filterable:"",placeholder:"请选择"},on:{change:t.change},model:{value:t.input,callback:function(e){t.input=e},expression:"input"}},t._l(t.options,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}))],1),t._v(" "),a("el-form-item",[a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"click全选/ctrl + click清空",placement:"top-start"}},[a("el-button",{attrs:{size:"small"},on:{click:[function(e){return"button"in e||!t._k(e.keyCode,"left",37,e.key,["Left","ArrowLeft"])?"button"in e&&0!==e.button?null:t.chooseAll(e):null},function(e){return e.ctrlKey?t.clear(e):null}]}},[t._v("\n                全选/清空\n            ")])],1)],1)],1)},staticRenderFns:[]};var k=a("VU/8")(y,_,!1,function(t){a("7GQ7")},"data-v-55853b98",null).exports,x={name:"Where",data:()=>({wheres:[],tags:[],tagsValue:{},currTagValues:[]}),mounted(){h.a.$on("change-tags",t=>{this.tags=t[0],this.tagsValue=t[1]})},methods:{deleteCurr:function(t){this.wheres.splice(t,1),h.a.$emit("change-where",this.wheres)},addWhere:function(){this.wheres.push({name:this.tags[0].value,value:""})},change:function(){h.a.$emit("change-where",this.wheres)},querySearch:function(t,e){e(t?this.currTagValues.filter(this.filter(t)):this.currTagValues)},filter:t=>e=>-1!==e.value.toLowerCase().indexOf(t.toLowerCase()),onFocus:function(t){this.currTagValues=[],this.tagsValue[t].forEach(t=>{this.currTagValues.push({value:t})})}}},j={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v("\n\n    Where:\n    Tags\n\n\n    "),a("el-button",{attrs:{icon:"el-icon-plus",circle:"",size:"mini"},on:{click:t.addWhere}}),t._v(" "),t._l(t.wheres,function(e,s){return a("el-autocomplete",{key:s,staticStyle:{display:"block"},attrs:{"fetch-suggestions":t.querySearch,placeholder:"请输入内容"},on:{focus:function(a){t.onFocus(e.name)},change:t.change},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}},[a("el-select",{staticStyle:{width:"130px"},attrs:{slot:"prepend",placeholder:"请选择"},on:{change:t.change},slot:"prepend",model:{value:e.name,callback:function(a){t.$set(e,"name",a)},expression:"item.name"}},t._l(t.tags,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),t._v(" "),a("el-button",{attrs:{slot:"append"},on:{click:function(e){t.deleteCurr(s)}},slot:"append"},[t._v("-")])],1)})],2)},staticRenderFns:[]};var w=a("VU/8")(x,j,!1,function(t){a("Qy6h")},"data-v-12e2091c",null).exports,T={name:"LinkInfo",data(){return{kdb:{url:this.$kdb.url},rdb:{url:this.$rdb.url}}},created(){},methods:{change:function(){this.$kdb.url=this.kdb.url,h.a.$emit("change-kdb")}}},$={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",[a("el-form-item",{attrs:{label:"kairosdb url"}},[a("el-input",{on:{change:t.change},model:{value:t.kdb.url,callback:function(e){t.$set(t.kdb,"url",e)},expression:"kdb.url"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"关系数据库 url"}},[a("el-input",{model:{value:t.rdb.url,callback:function(e){t.$set(t.rdb,"url",e)},expression:"rdb.url"}})],1)],1)},staticRenderFns:[]};var z=a("VU/8")(T,$,!1,function(t){a("HwxV")},"data-v-bae19e1c",null).exports,D=a("8vCp"),E={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"添加Metric",name:"addMetric"}},[a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-form",{attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"Metric","label-width":"80px"}},[a("el-input",{attrs:{placeholder:"输入Metric名称"},model:{value:t.inputMetricName,callback:function(e){t.inputMetricName=e},expression:"inputMetricName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"Tags","label-width":"80px"}},[t._l(t.dynamicTags,function(e){return a("el-tag",{key:e,attrs:{closable:"","disable-transitions":!1},on:{close:function(a){t.handleClose(e)}}},[t._v("\n                        "+t._s(e)+"\n                    ")])}),t._v(" "),t.inputTagVisible?a("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.handleInputConfirm(e):null}},model:{value:t.inputTagValue,callback:function(e){t.inputTagValue=e},expression:"inputTagValue"}}):a("el-button",{staticClass:"button-new-tag",attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ New Tag")])],2),t._v(" "),a("el-form-item",{attrs:{"label-width":"80px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addMetric}},[t._v("Add")])],1)],1)],1)]),t._v(" "),a("el-tab-pane",{attrs:{label:"添加数据点",name:"addData"}},[a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("div",{staticStyle:{display:"flex","justify-content":"center","flex-direction":"column",width:"40%"}},[a("div",[a("el-form",{attrs:{"label-position":"left"}},[a("metric",{on:{message:t.updateMetric}}),t._v(" "),t._l(t.totalTags,function(e,s){return a("el-form-item",{key:s,attrs:{label:e.label,"label-width":"120px"}},[a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.querySearch},on:{focus:function(a){t.onFocus(e.name)}},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)}),t._v(" "),a("date-picker",{on:{message:t.updateDate}})],2)],1),t._v(" "),a("div",[a("el-form",{attrs:{"label-position":"left"}},[a("el-form-item",{attrs:{label:"数据生成器","label-width":"120px"}},[a("el-input",{attrs:{type:"textarea",rows:10},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}})],1),t._v(" "),a("el-form-item",{attrs:{"label-width":"120px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("submit")])],1)],1)],1)])])])],1)},staticRenderFns:[]};var V=function(t){a("W6yz")},C=a("VU/8")(D.a,E,!1,V,"data-v-160c8759",null).exports,F={name:"insert",components:{metric:c.a,"date-picker":u.a},data:()=>({labelPosition:"right",totalTags:[],activeName:"deleteData",metricName:"",tags:{},date:[],value:"40.3322",loading:!1,tagsValue:{},currTagValues:[]}),created(){},methods:{updateMetric:function(t){this.metricName=t,this.getTags(t)},updateDate:function(t){this.date=t.map(t=>(t.setMilliseconds(0),t.getTime()))},getTags:function(t){this.totalTags=[];var e={metrics:[{tags:{},name:t}],plugins:[],cache_time:0,start_absolute:0};this.loading=!0,this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/query/tags",e).then(t=>{var e=t.data.queries[0].results[0].tags;for(var a in e)this.totalTags.push({label:a,name:a,value:""});this.tagsValue=e,this.loading=!1},t=>{this.loading=!1})},submit:function(){this.clearParam();for(let t,e=0;t=this.totalTags[e++];)this.tags[t.name]=[t.value];let t=this.date[0],e=this.date[1],a={metrics:[]};a.metrics.push({tags:this.tags,name:this.metricName}),a.plugins=[],a.cache_time=0,a.start_absolute=t,a.end_absolute=e,this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/delete",a).then(t=>{this.loading=!1,this.$message({message:"删除成功",type:"success"})},t=>{this.loading=!1,this.$message.error("删除失败")})},clearParam:function(){this.tags={},this.datapoints=[]},querySearch:function(t,e){e(t?this.currTagValues.filter(this.filter(t)):this.currTagValues)},filter:t=>e=>-1!==e.value.toLowerCase().indexOf(t.toLowerCase()),onFocus:function(t){this.currTagValues=[],this.tagsValue[t].forEach(t=>{this.currTagValues.push({value:t})})}}},M={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"card"},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"删除数据点",name:"deleteData"}},[a("div",{staticStyle:{display:"flex","justify-content":"center"}},[a("el-form",{attrs:{"label-position":"left"}},[a("metric",{on:{message:t.updateMetric}}),t._v(" "),t._l(t.totalTags,function(e,s){return a("el-form-item",{key:s,attrs:{label:e.label,"label-width":"120px"}},[a("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"fetch-suggestions":t.querySearch,multiple:""},on:{focus:function(a){t.onFocus(e.name)}},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}})],1)}),t._v(" "),a("date-picker",{on:{message:t.updateDate}}),t._v(" "),a("el-form-item",{attrs:{"label-width":"120px"}},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("submit")])],1)],2)],1)])],1)},staticRenderFns:[]};var N=a("VU/8")(F,M,!1,function(t){a("M4Cq")},"data-v-23ce5e9f",null).exports,P={name:"tabPane",components:{metric:c.a,"date-picker":u.a,"data-table":b,"group-by":k,where:w,"link-info":z,insert:C,delete:N},data:()=>({activeName:"urlInfo",metric:"",startDate:null,endDate:null,tableData:{columns:[],data:[],tags:[],metric:""},tags:[],where:{},loading:!1}),created(){},mounted(){h.a.$on("changeGroupBy",t=>{let e;this.tags=t,this.tableData.columns.length=0,this.tableData.data.length=0,this.pointTemplate={};for(let t=0;e=this.tags[t++];)this.tableData.columns.push({key:e,name:e}),this.pointTemplate[e]=""}),h.a.$on("change-where",t=>{let e;var a={};for(let s=0;e=t[s++];)void 0===a[e.name]&&(a[e.name]=[]),a[e.name].push(e.value);this.where=a})},methods:{handleClick(t,e){console.log(t,e)},updateMetric:function(t){console.log(t),this.metric=t},updateDate:function(t){console.log(t),this.startDate=t[0],this.endDate=t[1]},submit:function(){const t={},e=[];e.push({name:"tag",tags:this.tags}),t.metrics=[],t.metrics.push({tags:this.where,name:this.metric,group_by:e}),t.plugins=[],t.cache_time=0,this.startDate.setMilliseconds(0),this.endDate.setMilliseconds(0),t.start_absolute=this.startDate.getTime(),t.end_absolute=this.endDate.getTime(),this.loading=!0,this.$util.axios.post(this.$kdb.url+"/api/v1/datapoints/query",t).then(t=>{console.log(t);let e,a,s,i=t.data.queries[0].results,n=[];for(let t=0;e=i[t++];)if(Object.keys(e.tags).length===this.tags.length)for(let t=0;s=e.values[t++];){a={};for(let t in e.tags)a[t+""]=e.tags[t+""][0];a.date=this.$util.moment(new Date(s[0])).format("YYYY-MM-DD HH:mm:ss.SSS"),a.time=s[0],a.value=s[1],a.editFlag=!1,n.push(a)}this.tableData.data=n,this.tableData.metric=this.metric,this.tableData.tags=this.tags,h.a.$emit("table-data-change",n),this.loading=!1,this.activeName="queryResult"}).catch(function(t){console.log(t),this.loading=!1})}}},q={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"card","element-loading-text":"拼命加载中"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"链接信息",name:"urlInfo"}},[a("link-info")],1),t._v(" "),a("el-tab-pane",{attrs:{label:"条件",name:"condition"}},[a("el-form",{attrs:{inline:!0,"label-position":"left"}},[a("metric",{on:{message:t.updateMetric}}),t._v(" "),a("date-picker",{on:{message:t.updateDate}}),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.submit}},[t._v("submit")])],1)],1),t._v(" "),a("el-form",{attrs:{inline:!0,"label-position":"left"}},[a("group-by",{attrs:{"metric-name":t.metric}})],1),t._v(" "),a("where")],1),t._v(" "),a("el-tab-pane",{attrs:{label:"结果",name:"queryResult"}},[a("data-table",t._b({},"data-table",t.tableData,!1))],1),t._v(" "),a("el-tab-pane",{attrs:{label:"添加",name:"insert"}},[a("insert")],1),t._v(" "),a("el-tab-pane",{attrs:{label:"删除",name:"delete"}},[a("delete")],1)],1)},staticRenderFns:[]};var S={components:{"tab-pane":a("VU/8")(P,q,!1,function(t){a("jqC0")},"data-v-68bf24d8",null).exports},data:()=>({}),mounted(){},methods:{}},O={render:function(){var t=this.$createElement,e=this._self._c||t;return e("el-container",[e("el-header",{attrs:{height:"30px"}},[this._v("kclient")]),this._v(" "),e("el-container",[e("el-main",[e("tab-pane")],1)],1)],1)},staticRenderFns:[]},R=a("VU/8")(S,O,!1,null,null,null).exports;s.default.use(o.a);var L=new o.a({routes:[{path:"/",name:"Index",component:R}]}),U=a("PJh5"),W=a.n(U),I=a("mtWM"),B=a.n(I),A={moment:W.a,axios:B.a};s.default.prototype.$kdb={url:"http://127.0.0.1:8080"},s.default.prototype.$rdb={url:""},s.default.prototype.$util=A,s.default.config.productionTip=!1,s.default.use(n.a),new s.default({el:"#app",router:L,components:{App:r},template:"<App/>"})},PmuS:function(t,e){},Qy6h:function(t,e){},W6yz:function(t,e){},gsu9:function(t,e){},jqC0:function(t,e){},tvR6:function(t,e){},uslO:function(t,e,a){var s={"./af":"3CJN","./af.js":"3CJN","./ar":"3MVc","./ar-dz":"tkWw","./ar-dz.js":"tkWw","./ar-kw":"j8cJ","./ar-kw.js":"j8cJ","./ar-ly":"wPpW","./ar-ly.js":"wPpW","./ar-ma":"dURR","./ar-ma.js":"dURR","./ar-sa":"7OnE","./ar-sa.js":"7OnE","./ar-tn":"BEem","./ar-tn.js":"BEem","./ar.js":"3MVc","./az":"eHwN","./az.js":"eHwN","./be":"3hfc","./be.js":"3hfc","./bg":"lOED","./bg.js":"lOED","./bm":"hng5","./bm.js":"hng5","./bn":"aM0x","./bn.js":"aM0x","./bo":"w2Hs","./bo.js":"w2Hs","./br":"OSsP","./br.js":"OSsP","./bs":"aqvp","./bs.js":"aqvp","./ca":"wIgY","./ca.js":"wIgY","./cs":"ssxj","./cs.js":"ssxj","./cv":"N3vo","./cv.js":"N3vo","./cy":"ZFGz","./cy.js":"ZFGz","./da":"YBA/","./da.js":"YBA/","./de":"DOkx","./de-at":"8v14","./de-at.js":"8v14","./de-ch":"Frex","./de-ch.js":"Frex","./de.js":"DOkx","./dv":"rIuo","./dv.js":"rIuo","./el":"CFqe","./el.js":"CFqe","./en-au":"Sjoy","./en-au.js":"Sjoy","./en-ca":"Tqun","./en-ca.js":"Tqun","./en-gb":"hPuz","./en-gb.js":"hPuz","./en-ie":"ALEw","./en-ie.js":"ALEw","./en-il":"QZk1","./en-il.js":"QZk1","./en-nz":"dyB6","./en-nz.js":"dyB6","./eo":"Nd3h","./eo.js":"Nd3h","./es":"LT9G","./es-do":"7MHZ","./es-do.js":"7MHZ","./es-us":"INcR","./es-us.js":"INcR","./es.js":"LT9G","./et":"XlWM","./et.js":"XlWM","./eu":"sqLM","./eu.js":"sqLM","./fa":"2pmY","./fa.js":"2pmY","./fi":"nS2h","./fi.js":"nS2h","./fo":"OVPi","./fo.js":"OVPi","./fr":"tzHd","./fr-ca":"bXQP","./fr-ca.js":"bXQP","./fr-ch":"VK9h","./fr-ch.js":"VK9h","./fr.js":"tzHd","./fy":"g7KF","./fy.js":"g7KF","./gd":"nLOz","./gd.js":"nLOz","./gl":"FuaP","./gl.js":"FuaP","./gom-latn":"+27R","./gom-latn.js":"+27R","./gu":"rtsW","./gu.js":"rtsW","./he":"Nzt2","./he.js":"Nzt2","./hi":"ETHv","./hi.js":"ETHv","./hr":"V4qH","./hr.js":"V4qH","./hu":"xne+","./hu.js":"xne+","./hy-am":"GrS7","./hy-am.js":"GrS7","./id":"yRTJ","./id.js":"yRTJ","./is":"upln","./is.js":"upln","./it":"FKXc","./it.js":"FKXc","./ja":"ORgI","./ja.js":"ORgI","./jv":"JwiF","./jv.js":"JwiF","./ka":"RnJI","./ka.js":"RnJI","./kk":"j+vx","./kk.js":"j+vx","./km":"5j66","./km.js":"5j66","./kn":"gEQe","./kn.js":"gEQe","./ko":"eBB/","./ko.js":"eBB/","./ky":"6cf8","./ky.js":"6cf8","./lb":"z3hR","./lb.js":"z3hR","./lo":"nE8X","./lo.js":"nE8X","./lt":"/6P1","./lt.js":"/6P1","./lv":"jxEH","./lv.js":"jxEH","./me":"svD2","./me.js":"svD2","./mi":"gEU3","./mi.js":"gEU3","./mk":"Ab7C","./mk.js":"Ab7C","./ml":"oo1B","./ml.js":"oo1B","./mn":"CqHt","./mn.js":"CqHt","./mr":"5vPg","./mr.js":"5vPg","./ms":"ooba","./ms-my":"G++c","./ms-my.js":"G++c","./ms.js":"ooba","./mt":"oCzW","./mt.js":"oCzW","./my":"F+2e","./my.js":"F+2e","./nb":"FlzV","./nb.js":"FlzV","./ne":"/mhn","./ne.js":"/mhn","./nl":"3K28","./nl-be":"Bp2f","./nl-be.js":"Bp2f","./nl.js":"3K28","./nn":"C7av","./nn.js":"C7av","./pa-in":"pfs9","./pa-in.js":"pfs9","./pl":"7LV+","./pl.js":"7LV+","./pt":"ZoSI","./pt-br":"AoDM","./pt-br.js":"AoDM","./pt.js":"ZoSI","./ro":"wT5f","./ro.js":"wT5f","./ru":"ulq9","./ru.js":"ulq9","./sd":"fW1y","./sd.js":"fW1y","./se":"5Omq","./se.js":"5Omq","./si":"Lgqo","./si.js":"Lgqo","./sk":"OUMt","./sk.js":"OUMt","./sl":"2s1U","./sl.js":"2s1U","./sq":"V0td","./sq.js":"V0td","./sr":"f4W3","./sr-cyrl":"c1x4","./sr-cyrl.js":"c1x4","./sr.js":"f4W3","./ss":"7Q8x","./ss.js":"7Q8x","./sv":"Fpqq","./sv.js":"Fpqq","./sw":"DSXN","./sw.js":"DSXN","./ta":"+7/x","./ta.js":"+7/x","./te":"Nlnz","./te.js":"Nlnz","./tet":"gUgh","./tet.js":"gUgh","./tg":"5SNd","./tg.js":"5SNd","./th":"XzD+","./th.js":"XzD+","./tl-ph":"3LKG","./tl-ph.js":"3LKG","./tlh":"m7yE","./tlh.js":"m7yE","./tr":"k+5o","./tr.js":"k+5o","./tzl":"iNtv","./tzl.js":"iNtv","./tzm":"FRPF","./tzm-latn":"krPU","./tzm-latn.js":"krPU","./tzm.js":"FRPF","./ug-cn":"To0v","./ug-cn.js":"To0v","./uk":"ntHu","./uk.js":"ntHu","./ur":"uSe8","./ur.js":"uSe8","./uz":"XU1s","./uz-latn":"/bsm","./uz-latn.js":"/bsm","./uz.js":"XU1s","./vi":"0X8Q","./vi.js":"0X8Q","./x-pseudo":"e/KL","./x-pseudo.js":"e/KL","./yo":"YXlc","./yo.js":"YXlc","./zh-cn":"Vz2w","./zh-cn.js":"Vz2w","./zh-hk":"ZUyn","./zh-hk.js":"ZUyn","./zh-tw":"BbgG","./zh-tw.js":"BbgG"};function i(t){return a(n(t))}function n(t){var e=s[t];if(!(e+1))throw new Error("Cannot find module '"+t+"'.");return e}i.keys=function(){return Object.keys(s)},i.resolve=n,t.exports=i,i.id="uslO"}},["NHnr"]);
//# sourceMappingURL=app.ae0794974b9fb180c32b.js.map